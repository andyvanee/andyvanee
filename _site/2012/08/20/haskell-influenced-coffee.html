<!DOCTYPE html>
<html>
  <head>
    <title>andyvanee.com - Haskell Influenced Coffee</title>
    <link href="http://fonts.googleapis.com/css?family=Rokkitt:700|Cantarell:400,700,400italic" rel="stylesheet" type="text/css">
    <link href="/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/css/a.css" rel="stylesheet" type="text/css">
    <link rel="alternate" type="application/rss+xml" title="andyvanee.com feed" href="http://andyvanee.com/feed.xml" />
  </head>
  <body>
  <div class="container">
    <div class="row">
      <div class="span8">
        <h1 class="page-title"><a href="/">andyvanee</a><span class="subhead">blog</span></h1>
      </div>
      <div class="span8">
        <div class="post-single">
  <h2>
    <a href="/2012/08/20/haskell-influenced-coffee.html">Haskell Influenced Coffee</a>
    <span class="date">20-Aug-2012</span>
  </h2>
  <p>I&#8217;ve been learning Haskell. It&#8217;s been a very interesting experience to learn to think in the Haskell way, but I have been unsure whether it will actually have any practical benefit in my day to day work.</p>

<p>Then I switched modes and wrote a little CoffeeScript. The lessons I had been struggling with Haskell suddenly became so clear when applied to CoffeeScript (and JavaScript, by extension). Here&#8217;s a few examples of what I&#8217;m talking about&#8230;</p>

<h3 id='example_1__callbacks_with_scope'>Example #1 - Callbacks with scope</h3>

<p>Asynchronous execution is pretty fundamental in modern JavaScript, and callbacks are the way this is usually managed. Sometimes it makes sense to pass small inline anonymous functions in these cases, but other times you want to break the callback into it&#8217;s own named function. The problem that can arise with this is that your function might lose things it previously had in scope.</p>

<p>Take this example of reading a file asynchronously with node (inside a request):</p>
<script src='https://gist.github.com/3443765.js?file=inline_callback.coffee'> </script>
<p>Not bad, but those inline functions are essentially untestable and have a tendency to grow in ugly ways. I&#8217;d like to break it into it&#8217;s own named function, but I have a problem: my response handle will go out of scope so I can&#8217;t actually write my response. My Haskell-influenced solution uses a function-returning function and looks surprisingly like a Haskell type signature:</p>
<script src='https://gist.github.com/3443765.js?file=scoped_callback_constructor.coffee'> </script>
<p>So this is a function that returns a callback function (taking err,data) with the proper response writer in scope. Nice!</p>

<p>And now, with a minimal mock of res, err and data, it would be nice and easy to test the output of the responder across many inputs.</p>

<h3 id='example_2__loving_recursion'>Example #2 - Loving Recursion</h3>

<p>This one is a bit more of a gray area for me. Recursion can be slower and harder to understand for some. I&#8217;ve found that I naturally tend to solve things recursively more since using Haskell. Here&#8217;s a simple example that pads a string with another string up to a certain length. I didn&#8217;t even think, &#8220;I should do this recursively&#8221;, it just came naturally.</p>
<script src='https://gist.github.com/3443765.js?file=recursion.coffee'> </script>
<p>Now we can change &#8220;7&#8221; to &#8220;007&#8221;, just by doing <code>&quot;7&quot;.pad(&quot;0&quot;, 3)</code>. Sure, this could have been done just fine with a while or for loop. The thing I like about recursive solutions is that the edge conditions are clearer than in an iterative solution.</p>

<h3 id='example_3__functional_decomposition'>Example #3 - Functional Decomposition</h3>

<p>One definite influence of writing Haskell is the size of functions I&#8217;ve been writing. Each function is only a couple lines long and does a single thing. Here&#8217;s an excerpt of some filename processing I did:</p>
<script src='https://gist.github.com/3443765.js?file=decomposition.coffee'> </script>
<p>In the past, it&#8217;s quite possible that I wouldn&#8217;t have even created a single function for this, much less three. It&#8217;s only a couple string replacements which wouldn&#8217;t have cluttered up the calling code too much. As it turns out, I was able to use this inside a string interpolation which was much cleaner and more or less self-documenting.</p>
<script src='https://gist.github.com/3443765.js?file=template_call.coffee'> </script>
</div>
<p>
    tags:
    
    <a class="badge badge-info" href="/tag/Programming/">
        Programming
    </a>
    
</p>
<p class="well">
    <a href="mailto:andy@andyvanee.com?subject=Comments%20on%3A%20Haskell Influenced Coffee">
        Email
    </a>
    your comments to me. I will try to respond to all comments either by revising the
    post, or by responding personally. I promise not post or otherwise mishandle
    your email address.
</p>
      </div>
      <div class="span8 footer">
        <div class="inside">
          <p><a href="/">andyvanee.com</a> | <a href="https://github.com/Andyvanee/andyvanee.github.com/wiki">wiki</a></p>
        </div>
      </div>
    </div>
  </body>
  <script type="text/javascript" charset="utf-8" src="/js/jquery.min.js"></script>
  <script type="text/javascript" charset="utf-8" src="/js/app.min.js"></script>
</html>
