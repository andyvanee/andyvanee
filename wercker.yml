box: wercker/ruby@1.0.0
build:
    steps:
        - script:
            name: install latest bundler
            code: gem install bundler --version '>= 1.7'
        # Execute the bundle install step, a step provided by wercker
        - wercker/bundle-install@2.0.1
        # Execute a custom script step.
        - script:
            name: middleman build
            code: bundle exec middleman build --verbose
deploy:
    steps:
        # Execute the s3sync deploy step, a step provided by wercker
        # Cache-Control is set to one day
        - s3sync:
            key_id: $AWS_ACCESS_KEY
            key_secret: $AWS_SECRET_KEY
            bucket_url: $AWS_BUCKET_URL
            source_dir: build/
            opts: --acl-public --add-header=Cache-Control:public, max-age=86400
